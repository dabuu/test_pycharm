<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <title>$page_title</title>
    <script language="javascript" type="text/javascript" src="../jquery/jquery-1.11.1.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/main.css" />
</head>
<body>
    <div class="answer_result">
        这里显示结果。。
    </div>
    <form name="questions" method="post" action="">
        <div class="q_container">
            <div class="q_title">
                <label>测试题 A</label>
            </div>
            <p>题目是xXXXXXXXXXXXXXX</p>
            <ul>
                <li><input type="radio" value="1" name="A" id="A1"/><label for="A1">A111</label></li>
                <li><input type="radio" value="2" name="A" id="A2"/><label for="A2">A222</label></li>
                <li><input type="radio" value="3" name="A" id="A3"/><label for="A3">A333</label></li>
                <li><input type="radio" value="4" name="A" id="A4"/><label for="A4">A444</label></li>
            </ul>
            <div class="explain_container" align="center">
                <p class="explain" id="A_E"></p>
            </div>
        </div>
        <div class="q_container">
            <div class="q_title">
                <label>测试题 B</label>
            </div>
            <p>题目是xXXXXXXXXXXXXXX</p>
            <ul>
                <li><input type="checkbox" value="1" name="23[]" id="B1"/><label for="B1">B111</label></li>
                <li><input type="checkbox" value="2" name="23[]" id="B2"/><label for="B2">B222</label></li>
                <li><input type="checkbox" value="3" name="23[]" id="B3"/><label for="B3">B333</label></li>
                <li><input type="checkbox" value="4" name="23[]" id="B4"/><label for="B4">B444</label></li>
            </ul>
            <div class="explain_container" align="center">
                <p class="explain" id="B_E"></p>
            </div>
        </div>
        <div class="q_container">
            <div class="q_title">
                <label>测试题 C</label>
            </div>
            <p>题目是xXXXXXXXXXXXXXX</p>
            <ul>
                <li><input type="radio" value="1" name="C" id="C1"/><label for="C1">C111</label></li>
                <li><input type="radio" value="2" name="C" id="C2"/><label for="C2">C222</label></li>
                <li><input type="radio" value="3" name="C" id="C3"/><label for="C3">C333</label></li>
                <li><input type="radio" value="4" name="C" id="C4"/><label for="C4">C444</label></li>
            </ul>
            <div class="explain_container" align="center">
                <p class="explain" id="C_E"></p>
            </div>
        </div>
        <input type="button" value="提交答案" name="submitanswer" id="submitanswer" disabled="disabled"/>
        <input type="hidden" value="user_db_id" name="info"/>
        <!--用结果用 二进制数+0 表示：bindec,decbin -->
    </form>
<div id="result">[test]</div>
</body>
<SCRIPT type="text/javascript">
    $(document).ready(function(){

        $(":radio,:checkbox").change(function(){
            is_submit_enable();
        });
//        $(":checkbox").change(function(){
//           is_submit_enable();
//        });

        $("input#submitanswer").click(function(){
//            alert($("form:first").serialize());
////            提交 包括： 1. user_db_id
////            2. 所有的答案
//            $("form:first").submit();
//            return true;
            $("input#submitanswer").val("提交中...");
            $("input#submitanswer").attr("disabled","disable").css("background-color","");
            $.ajax({
                type:"post",
                url: "checkanswer.php",
                dataType:"json",
                data:$("form:first").serialize(),
                success:function(data){
                    $("#result").after(data);
                    var objs = data;
                    for(var key in objs)
                    {
                        $("#"+key+"_E").html("这里显示 答案 和解释:" + objs[key]['explain']);
                    }
                    $("input#submitanswer").hide();
                },
                error:function(XMLHttpRequest, textStatus, errorThrown){
                    alert(errorThrown);
                    $("input#submitanswer").val("提交答案!");
                }
            });

//            $.post(
//                    "checkanswer.php",
//                    $("form:first").serialize(),
//                    function(data)
//                    {
//                        $("#result").after(data);
//                        var objs = eval("("+data+")");
//                        for(var key in objs)
//                        {
//                            $("#"+key+"_E").html("这里显示 答案 和解释:" + objs[key]['explain']);
//                        }
//                        $("input#submitanswer").hide();
//                    }
//http://www.cnblogs.com/ccdc/archive/2012/04/18/2455637.html
//            AJAX可以用JSON传值
//            比如PHP端一个数组是$arr
//            利用  echo  json_encode($arr)
//            在客户端用AJAX可以接收这个数组
//            );

            //return true;
        });

        function is_submit_enable(){
//            if($("input:checkbox").is(":checked") && $("input:radio").is(":checked")){
            if($('div.q_container:not(:has(:checked))').length == 0){
                $("input[name=submitanswer]").removeAttr("disabled").css("background-color","orange");
            }
            else
            {
                $("input[name=submitanswer]").attr("disabled","disable").css("background-color","");
            }
        }
    });
</SCRIPT>
</html>